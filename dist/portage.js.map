{"version":3,"sources":["../webpack/universalModuleDefinition","../webpack/bootstrap ecadeb675ab5ac9cfe3e",".././src/portage.js",".././src/Channel.js","../external {\"root\":\"_\",\"commonjs2\":\"lodash\",\"commonjs\":\"lodash\",\"amd\":\"lodash\"}","../external {\"root\":\"FuzzyTree\",\"commonjs2\":\"fuzzytree\",\"commonjs\":\"fuzzytree\",\"amd\":\"fuzzytree\"}",".././src/Subscription.js",".././src/Hub.js"],"names":[],"mappings":"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","file":"dist/portage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"fuzzytree\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"fuzzytree\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"portage\"] = factory(require(\"lodash\"), require(\"fuzzytree\"));\n\telse\n\t\troot[\"portage\"] = factory(root[\"_\"], root[\"FuzzyTree\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ecadeb675ab5ac9cfe3e\n **/","/* jshint esnext:true */\n\nimport Channel from './Channel';\nimport Hub from './Hub';\nimport Subscription from './Subscription';\n\nvar defaultHub = new Hub();\n\ndefaultHub.Channel = Channel;\ndefaultHub.Hub = Hub;\ndefaultHub.Subscription = Subscription;\n\nexport default defaultHub;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/portage.js\n **/","/* jshint esnext:true */\n\nimport {\n    isFunction as _isFunction,\n    forEach as _forEach,\n    reduce as _reduce\n} from 'lodash';\nimport FuzzyTree from 'fuzzytree';\nimport Subscription from './Subscription';\n\nclass Channel{\n    constructor(){\n        this._tree = new FuzzyTree();\n    }\n\n    subscribe(topic, cb){\n        if (!_isFunction(cb)) throw Error(\"callback must be a function\");\n\n        var node = this._tree.find(topic);\n        if (!node) {\n            node = this._tree.insert(topic);\n            node.setData([]);\n        }\n        var s = new Subscription(cb, node.getData());\n        node.getData().push(s);\n        return s;\n    }\n\n    publish(topic, data){\n        var nodes = this._tree.match(topic),\n            subs = _reduce(nodes, (subs, node) => {\n                _forEach(node.getData(), s => subs.push(s));\n                return subs;\n            }, []);\n        _forEach(subs, s => s.invoke(data, {\n            topic: topic,\n            called: s._called,\n            limit: s._limit,\n            last: s._limit !== null && s._called === s._limit - 1\n        }));\n    }\n}\n\nexport default Channel;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Channel.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs2\":\"lodash\",\"commonjs\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"FuzzyTree\",\"commonjs2\":\"fuzzytree\",\"commonjs\":\"fuzzytree\",\"amd\":\"fuzzytree\"}\n ** module id = 3\n ** module chunks = 0\n **/","/* jshint esnext:true */\n\nimport {\n    isNumber as _isNumber,\n    isNaN as _isNaN,\n    gte as _gte,\n    indexOf as _indexOf\n} from 'lodash';\n\nclass Subscription{\n    constructor(cb, container){\n        this._cb = cb;\n        this._container = container;\n        this._called = 0;\n        this._limit = null;\n    }\n\n    invoke(data, meta){\n        var r = this._cb(data, meta);\n        this._called++;\n        this._purge();\n        return r;\n    }\n\n    _purge(){\n        if (this._limit !== null && this._called >= this._limit)\n            this.unsubscribe();\n    }\n\n    limit(n){\n        if (!(_isNumber(n) && !_isNaN(n) && _gte(n, 0)))\n            throw Error(\"limit must be a number greater or equal to 0\");\n        this._limit = this._called + n;\n        this._purge();\n        return this;\n    }\n\n    once(){\n        return this.limit(1);\n    }\n\n    unsubscribe(){\n        var i = _indexOf(this._container, this);\n        if (i !== -1) this._container.splice(i, 1);\n    }\n}\n\nexport default Subscription;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Subscription.js\n **/","/* jshint esnext:true */\n\nimport {isString as _isString} from 'lodash';\nimport Channel from './Channel';\n\nclass Hub{\n    constructor(){\n        this._channels = {};\n    }\n\n    channel(name){\n        if (!_isString(name)) throw Error(\"channel name must be a string\");\n        return ( this._channels[name] = this._channels[name] || new Channel() );\n    }\n}\n\nexport default Hub;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Hub.js\n **/"],"sourceRoot":""}